<html layout:decorate="~{layout}"></html>

<div layout:fragment="content" class="container my-3">
    <div class="mb-3 d-flex justify-content-end">
        <a class="btn btn-outline-dark" th:href="@{/article/write}" th:text="|글 작성|"></a>
    </div>

    <table class="table table-hover">
        <thead class="table-dark">
        <tr>
            <th scope="col">번호</th>
            <th scope="col">제목</th>
            <th scope="col">글쓴이</th>
            <th scope="col">작성일시</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="article : ${paging}">
            <td class="col-1" th:text="${article.id}"></td>
            <td class="col-6">
                <a th:href="@{|/article/detail/${article.id}|}" th:text="${article.title}"></a>
                <span th:if="${#lists.size(article.commentList) > 0}"
                      class="mx-3 badge rounded-pill text-bg-success"
                      th:text="${#lists.size(article.commentList)}"></span>
            </td>
            <td class="col-2" th:if="${article.author != null}" th:text="${article.author.username}"></td>
            <td class="col-2" th:text="${#temporals.format(article.createdAt, 'yyyy.MM.dd HH:mm')}"></td>
        </tr>
        </tbody>
    </table>

    <div th:if="${!paging.isEmpty()}" class="d-flex justify-content-center">
        <!--pagination-->
        <nav aria-label="..." th:with="
        size=2,
        pageNumber=${paging.number},
        totalPages=${paging.totalPages},
        startPage=${pageNumber - size},
        endPage=${pageNumber + size},
        sp=(${startPage < 0 ? -startPage : 0}),
        ep=(${endPage > totalPages - 1 ? endPage - totalPages + 1 : 0}),
        start=${startPage - ep},
        end=${endPage + sp}
         ">
            <ul class="pagination">
                <li class="page-item"
                    th:classappend="${!paging.hasPrevious()} ? 'disabled'">
                    <a class="page-link" th:href="@{|/article/list?page=0|}"><<</a>
                </li>
                <li class="page-item"
                    th:classappend="${!paging.hasPrevious()} ? 'disabled'">
                    <a class="page-link" th:href="@{|/article/list?page=${paging.number - 1}|}">이전</a>
                </li>

                <li th:each="page : ${#numbers.sequence(start, end)}"
                    th:classappend="${page == paging.number} ? 'active'"
                    th:if="${0 <= page and page < totalPages}"
                    class="page-item">
                    <a class="page-link" th:href="@{|/article/list?page=${page}|}" th:text="${page + 1}"></a>
                </li>

                <li class="page-item" th:classappend="${!paging.hasNext()} ? 'disabled'">
                    <a class="page-link" th:href="@{|/article/list?page=${paging.number + 1}|}">다음</a>
                </li>
                <li class="page-item" th:classappend="${!paging.hasNext()} ? 'disabled'">
                    <a class="page-link" th:href="@{|/article/list?page=${paging.totalPages - 1}|}">>></a>
                </li>
            </ul>
        </nav>
    </div>
</div>

